#!/bin/bash

# create-component: React ì»´í¬ë„ŒíŠ¸ ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸ ìƒì„± ì»¤ë§¨ë“œ
# ì‚¬ìš©ë²•: create-component <ComponentName>
# ì˜ˆì‹œ: create-component Button

set -e

# ì»´í¬ë„ŒíŠ¸ ì´ë¦„ ì…ë ¥ í™•ì¸
if [ -z "$1" ]; then
  echo "âŒ ì—ëŸ¬: ì»´í¬ë„ŒíŠ¸ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”"
  echo "ì‚¬ìš©ë²•: create-component <ComponentName>"
  echo "ì˜ˆì‹œ: create-component Button"
  exit 1
fi

COMPONENT_NAME=$1
COMPONENT_PATH="components/$COMPONENT_NAME"

# ì´ë¯¸ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸
if [ -d "$COMPONENT_PATH" ]; then
  echo "âŒ ì—ëŸ¬: $COMPONENT_PATH í´ë”ê°€ ì´ë¯¸ ì¡´ì¬í•©ë‹ˆë‹¤"
  exit 1
fi

# í´ë” ìƒì„±
mkdir -p "$COMPONENT_PATH"
echo "âœ… í´ë” ìƒì„±: $COMPONENT_PATH"

# types.ts ìƒì„±
cat > "$COMPONENT_PATH/types.ts" << 'EOF'
// ì»´í¬ë„ŒíŠ¸ Props ì¸í„°í˜ì´ìŠ¤
export interface ${COMPONENT_NAME}Props {
  /**
   * ì»´í¬ë„ŒíŠ¸ ì„¤ëª…ì„ ì‘ì„±í•˜ì„¸ìš”
   * @example "Primary"
   */
  variant?: 'primary' | 'secondary' | 'outline';

  /**
   * í¬ê¸° ì„¤ì •
   * @example "md"
   */
  size?: 'sm' | 'md' | 'lg';

  /**
   * ë¹„í™œì„±í™” ìƒíƒœ
   * @default false
   */
  disabled?: boolean;

  /**
   * í´ë˜ìŠ¤ëª… ì¶”ê°€
   */
  className?: string;

  /**
   * ìì‹ ìš”ì†Œ
   */
  children?: React.ReactNode;
}
EOF

# ${COMPONENT_NAME} ì¹˜í™˜
sed -i "s/\${COMPONENT_NAME}/$COMPONENT_NAME/g" "$COMPONENT_PATH/types.ts"

echo "âœ… íŒŒì¼ ìƒì„±: $COMPONENT_PATH/types.ts"

# ì»´í¬ë„ŒíŠ¸ íŒŒì¼ ìƒì„±
cat > "$COMPONENT_PATH/$COMPONENT_NAME.tsx" << 'EOF'
'use client';

import React, { FC, useMemo } from 'react';
import PropTypes from 'prop-types';
import { ${COMPONENT_NAME}Props } from './types';

/**
 * ${COMPONENT_NAME} ì»´í¬ë„ŒíŠ¸
 *
 * ë°˜ì‘í˜• ë””ìì¸ ì§€ì›:
 * - ëª¨ë°”ì¼ (ê¸°ë³¸): 100% ë„ˆë¹„
 * - íƒœë¸”ë¦¿ (md): ì»¨í…Œì´ë„ˆ ë„ˆë¹„
 * - ë°ìŠ¤í¬í†± (lg): ìµœëŒ€ ë„ˆë¹„ ì œí•œ
 *
 * @example
 * <${COMPONENT_NAME} variant="primary" size="md">
 *   í´ë¦­í•˜ì„¸ìš”
 * </${COMPONENT_NAME}>
 */
const ${COMPONENT_NAME}: FC<${COMPONENT_NAME}Props> = ({
  variant = 'primary',
  size = 'md',
  disabled = false,
  className = '',
  children,
}) => {
  // ìŠ¤íƒ€ì¼ í´ë˜ìŠ¤ ìµœì í™”
  const styleClasses = useMemo(() => {
    const baseClasses = [
      'transition-all duration-200 ease-in-out',
      'font-medium rounded-lg',
      'focus:outline-none focus:ring-2 focus:ring-offset-2',
      disabled && 'opacity-50 cursor-not-allowed',
    ];

    // ë³€í˜• ìŠ¤íƒ€ì¼
    const variantClasses = {
      primary: 'bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500',
      secondary: 'bg-gray-200 text-gray-900 hover:bg-gray-300 focus:ring-gray-500',
      outline: 'border border-gray-300 text-gray-900 hover:bg-gray-50 focus:ring-gray-500',
    };

    // í¬ê¸° ìŠ¤íƒ€ì¼
    const sizeClasses = {
      sm: 'px-3 py-1.5 text-sm',
      md: 'px-4 py-2 text-base',
      lg: 'px-6 py-3 text-lg',
    };

    // ë°˜ì‘í˜• ìŠ¤íƒ€ì¼
    const responsiveClasses = [
      'w-full sm:w-auto', // ëª¨ë°”ì¼ì—ì„œ ì „ì²´ ë„ˆë¹„, íƒœë¸”ë¦¿ ì´ìƒì—ì„œ ìë™
      'md:px-5 md:py-2.5', // íƒœë¸”ë¦¿ì—ì„œ íŒ¨ë”© ì¡°ì •
      'lg:px-6 lg:py-3', // ë°ìŠ¤í¬í†±ì—ì„œ íŒ¨ë”© ì¡°ì •
    ];

    return [
      baseClasses.filter(Boolean).join(' '),
      variantClasses[variant],
      sizeClasses[size],
      responsiveClasses.join(' '),
      className,
    ]
      .filter(Boolean)
      .join(' ');
  }, [variant, size, disabled, className]);

  return (
    <button
      type="button"
      disabled={disabled}
      className={styleClasses}
      aria-disabled={disabled}
    >
      {children}
    </button>
  );
};

// Props ê²€ì¦
${COMPONENT_NAME}.propTypes = {
  variant: PropTypes.oneOf(['primary', 'secondary', 'outline']),
  size: PropTypes.oneOf(['sm', 'md', 'lg']),
  disabled: PropTypes.bool,
  className: PropTypes.string,
  children: PropTypes.node,
};

// ê¸°ë³¸ê°’ ì„¤ì •
${COMPONENT_NAME}.defaultProps = {
  variant: 'primary',
  size: 'md',
  disabled: false,
  className: '',
  children: null,
};

export default ${COMPONENT_NAME};
EOF

sed -i "s/\${COMPONENT_NAME}/$COMPONENT_NAME/g" "$COMPONENT_PATH/$COMPONENT_NAME.tsx"

echo "âœ… íŒŒì¼ ìƒì„±: $COMPONENT_PATH/$COMPONENT_NAME.tsx"

# index.ts ìƒì„± (Export íŒŒì¼)
cat > "$COMPONENT_PATH/index.ts" << 'EOF'
export { default as ${COMPONENT_NAME} } from './${COMPONENT_NAME}';
export type { ${COMPONENT_NAME}Props } from './types';
EOF

sed -i "s/\${COMPONENT_NAME}/$COMPONENT_NAME/g" "$COMPONENT_PATH/index.ts"

echo "âœ… íŒŒì¼ ìƒì„±: $COMPONENT_PATH/index.ts"

# ì™„ë£Œ ë©”ì‹œì§€
echo ""
echo "ğŸ‰ $COMPONENT_NAME ì»´í¬ë„ŒíŠ¸ ìƒì„± ì™„ë£Œ!"
echo ""
echo "ğŸ“‚ ìƒì„±ëœ íŒŒì¼:"
echo "   â€¢ $COMPONENT_PATH/$COMPONENT_NAME.tsx"
echo "   â€¢ $COMPONENT_PATH/types.ts"
echo "   â€¢ $COMPONENT_PATH/index.ts"
echo ""
echo "ğŸ“ ë‹¤ìŒ ë‹¨ê³„:"
echo "   1. íƒ€ì… ì •ì˜ ìˆ˜ì •: $COMPONENT_PATH/types.ts"
echo "   2. ì»´í¬ë„ŒíŠ¸ ë¡œì§ êµ¬í˜„: $COMPONENT_PATH/$COMPONENT_NAME.tsx"
echo "   3. ì‚¬ìš©: import { $COMPONENT_NAME } from '@/components/$COMPONENT_NAME';"
echo ""
echo "ğŸ¨ Tailwind CSS ë°˜ì‘í˜• í´ë˜ìŠ¤:"
echo "   â€¢ sm: 640px (ëª¨ë°”ì¼ íƒœë¸”ë¦¿)"
echo "   â€¢ md: 768px (íƒœë¸”ë¦¿)"
echo "   â€¢ lg: 1024px (ë°ìŠ¤í¬í†±)"
echo "   â€¢ xl: 1280px (ì™€ì´ë“œ ë°ìŠ¤í¬í†±)"
